%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.859870e+004; foe(n+1)=1.857458e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.440778e+004; foe(n+1)=1.438448e+004; krok(n+1)=2.025153e-004; ng(n+1)=5.379842e+003;
n=2; farx(n+1)=2.126348e+003; foe(n+1)=1.909345e+003; krok(n+1)=4.055547e-003; ng(n+1)=1.203652e+003;
n=3; farx(n+1)=2.157568e+003; foe(n+1)=1.726585e+003; krok(n+1)=2.714975e-005; ng(n+1)=5.275117e+003;
n=4; farx(n+1)=2.880513e+003; foe(n+1)=1.616936e+003; krok(n+1)=9.152390e-004; ng(n+1)=4.977855e+003;
n=5; farx(n+1)=2.223085e+003; foe(n+1)=1.476691e+003; krok(n+1)=2.063134e-003; ng(n+1)=1.889488e+003;
n=6; farx(n+1)=2.216830e+003; foe(n+1)=1.454608e+003; krok(n+1)=1.712669e-002; ng(n+1)=1.631981e+003;
n=7; farx(n+1)=2.197379e+003; foe(n+1)=1.387005e+003; krok(n+1)=3.277333e-002; ng(n+1)=1.620561e+003;
n=8; farx(n+1)=1.101599e+003; foe(n+1)=9.889995e+002; krok(n+1)=2.311700e+000; ng(n+1)=1.540149e+003;
n=9; farx(n+1)=9.530162e+002; foe(n+1)=9.669087e+002; krok(n+1)=9.540683e-001; ng(n+1)=3.241081e+002;
n=10; farx(n+1)=8.786776e+002; foe(n+1)=9.590701e+002; krok(n+1)=8.310156e-002; ng(n+1)=8.148700e+002;
n=11; farx(n+1)=8.076934e+002; foe(n+1)=9.459996e+002; krok(n+1)=5.015999e-001; ng(n+1)=8.214861e+002;
n=12; farx(n+1)=3.563063e+002; foe(n+1)=8.166854e+002; krok(n+1)=3.539781e+000; ng(n+1)=3.767543e+002;
n=13; farx(n+1)=3.534591e+002; foe(n+1)=8.164508e+002; krok(n+1)=5.162212e-005; ng(n+1)=1.301907e+004;
n=14; farx(n+1)=3.202769e+002; foe(n+1)=8.025844e+002; krok(n+1)=1.247419e-001; ng(n+1)=1.802271e+004;
n=15; farx(n+1)=2.888058e+002; foe(n+1)=7.746940e+002; krok(n+1)=9.035956e-002; ng(n+1)=5.255172e+004;
n=16; farx(n+1)=2.650632e+002; foe(n+1)=7.533225e+002; krok(n+1)=2.025137e-002; ng(n+1)=2.941662e+005;
n=17; farx(n+1)=2.513038e+002; foe(n+1)=7.393999e+002; krok(n+1)=2.191235e-002; ng(n+1)=7.763920e+005;
n=18; farx(n+1)=2.194341e+002; foe(n+1)=6.581290e+002; krok(n+1)=9.282613e-002; ng(n+1)=8.221264e+005;
n=19; farx(n+1)=2.129292e+002; foe(n+1)=6.421240e+002; krok(n+1)=3.923753e-002; ng(n+1)=6.668366e+004;
n=20; farx(n+1)=1.471195e+002; foe(n+1)=5.457070e+002; krok(n+1)=2.529970e-001; ng(n+1)=8.965578e+003;
n=21; farx(n+1)=1.096037e+002; foe(n+1)=5.042535e+002; krok(n+1)=3.138666e-001; ng(n+1)=2.212124e+003;
n=22; farx(n+1)=8.961909e+001; foe(n+1)=4.761553e+002; krok(n+1)=2.845227e-001; ng(n+1)=5.414932e+003;
n=23; farx(n+1)=7.787243e+001; foe(n+1)=4.227251e+002; krok(n+1)=1.447720e+000; ng(n+1)=1.467564e+003;
n=24; farx(n+1)=7.516362e+001; foe(n+1)=4.019313e+002; krok(n+1)=4.498732e-001; ng(n+1)=2.773545e+004;
n=25; farx(n+1)=5.685302e+001; foe(n+1)=3.637656e+002; krok(n+1)=1.021678e+000; ng(n+1)=1.342072e+004;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.592210e+001; foe(n+1)=3.616923e+002; krok(n+1)=7.821846e-006; ng(n+1)=1.346571e+003;
n=27; farx(n+1)=5.899125e+001; foe(n+1)=3.555666e+002; krok(n+1)=2.980900e-006; ng(n+1)=2.847477e+003;
n=28; farx(n+1)=5.329653e+001; foe(n+1)=3.488225e+002; krok(n+1)=1.055010e-004; ng(n+1)=1.118383e+003;
n=29; farx(n+1)=5.099616e+001; foe(n+1)=3.421971e+002; krok(n+1)=5.658127e-005; ng(n+1)=3.464478e+003;
n=30; farx(n+1)=4.620490e+001; foe(n+1)=3.300239e+002; krok(n+1)=2.224690e-004; ng(n+1)=1.924636e+003;
n=31; farx(n+1)=4.793156e+001; foe(n+1)=3.236365e+002; krok(n+1)=5.636956e-004; ng(n+1)=7.660757e+003;
n=32; farx(n+1)=4.101849e+001; foe(n+1)=3.125716e+002; krok(n+1)=8.662598e-002; ng(n+1)=1.032016e+004;
n=33; farx(n+1)=3.355936e+001; foe(n+1)=2.811107e+002; krok(n+1)=1.090115e+000; ng(n+1)=1.080548e+004;
n=34; farx(n+1)=3.172579e+001; foe(n+1)=2.663520e+002; krok(n+1)=8.256204e-001; ng(n+1)=3.101589e+003;
n=35; farx(n+1)=2.906669e+001; foe(n+1)=2.598929e+002; krok(n+1)=3.372291e-001; ng(n+1)=1.898788e+003;
n=36; farx(n+1)=2.509511e+001; foe(n+1)=2.543648e+002; krok(n+1)=5.520515e-001; ng(n+1)=5.904007e+003;
n=37; farx(n+1)=2.524714e+001; foe(n+1)=2.516462e+002; krok(n+1)=3.477470e-001; ng(n+1)=5.848351e+003;
n=38; farx(n+1)=2.631680e+001; foe(n+1)=2.483151e+002; krok(n+1)=8.620454e-001; ng(n+1)=3.521370e+003;
n=39; farx(n+1)=2.508389e+001; foe(n+1)=2.460187e+002; krok(n+1)=9.528451e-001; ng(n+1)=1.480884e+003;
n=40; farx(n+1)=2.453262e+001; foe(n+1)=2.450998e+002; krok(n+1)=6.744582e-001; ng(n+1)=6.976971e+002;
n=41; farx(n+1)=2.404216e+001; foe(n+1)=2.447398e+002; krok(n+1)=3.103642e-001; ng(n+1)=2.565584e+003;
n=42; farx(n+1)=2.416845e+001; foe(n+1)=2.444435e+002; krok(n+1)=1.120145e+000; ng(n+1)=8.540388e+002;
n=43; farx(n+1)=2.428890e+001; foe(n+1)=2.443908e+002; krok(n+1)=7.536472e-001; ng(n+1)=3.591535e+002;
n=44; farx(n+1)=2.412740e+001; foe(n+1)=2.443746e+002; krok(n+1)=1.505055e+000; ng(n+1)=4.289111e+001;
n=45; farx(n+1)=2.418336e+001; foe(n+1)=2.443616e+002; krok(n+1)=2.535448e+000; ng(n+1)=1.208800e+002;
n=46; farx(n+1)=2.415492e+001; foe(n+1)=2.443089e+002; krok(n+1)=3.781569e+000; ng(n+1)=2.766376e+002;
n=47; farx(n+1)=2.421413e+001; foe(n+1)=2.442457e+002; krok(n+1)=2.087756e+000; ng(n+1)=1.531558e+002;
n=48; farx(n+1)=2.374366e+001; foe(n+1)=2.441716e+002; krok(n+1)=4.004620e+000; ng(n+1)=6.049451e+002;
n=49; farx(n+1)=2.378102e+001; foe(n+1)=2.441460e+002; krok(n+1)=1.307567e+000; ng(n+1)=1.045424e+002;
n=50; farx(n+1)=2.377736e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.576737e-001; ng(n+1)=3.087993e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.377720e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.365142e-007; ng(n+1)=5.961495e+000;
n=52; farx(n+1)=2.377710e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.717423e-006; ng(n+1)=1.090116e+000;
n=53; farx(n+1)=2.377633e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.953303e-005; ng(n+1)=3.759307e-001;
n=54; farx(n+1)=2.377686e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.259539e-004; ng(n+1)=1.663181e-001;
n=55; farx(n+1)=2.377856e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.432951e-004; ng(n+1)=8.472483e-002;
n=56; farx(n+1)=2.377766e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.835014e-002; ng(n+1)=1.125564e-002;
n=57; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.761298e-002; ng(n+1)=4.130446e-003;
n=58; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.102966e-006; ng(n+1)=3.725558e-003;
n=59; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.750347e-009; ng(n+1)=3.725539e-003;
n=60; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.948183e-009; ng(n+1)=3.725539e-003;
n=61; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.679891e-010; ng(n+1)=3.725534e-003;
n=62; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.291156e-009; ng(n+1)=3.725534e-003;
n=63; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.602714e-008; ng(n+1)=3.725534e-003;
 % z造 kierunek w metodzie zm - odnowa 
n=64; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.441655e-006; ng(n+1)=3.725534e-003;
n=65; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.465632e-007; ng(n+1)=1.648557e-002;
n=66; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.725370e-005; ng(n+1)=3.237941e-003;
n=67; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.648479e-004; ng(n+1)=2.299198e-003;
n=68; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.448771e-006; ng(n+1)=1.707541e-003;
n=69; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.174027e-006; ng(n+1)=1.707440e-003;
n=70; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.133088e-007; ng(n+1)=1.707426e-003;
n=71; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.150764e-009; ng(n+1)=1.707423e-003;
n=72; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.057719e-009; ng(n+1)=1.707424e-003;
n=73; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.316139e-010; ng(n+1)=1.707424e-003;
n=74; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.607809e-009; ng(n+1)=1.707424e-003;
 % z造 kierunek w metodzie zm - odnowa 
n=75; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.048465e-014; ng(n+1)=1.707423e-003;
%odnowa zmiennej metryki
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
