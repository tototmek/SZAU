%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.857789e+004; foe(n+1)=1.859233e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.445077e+004; foe(n+1)=1.445012e+004; krok(n+1)=1.997041e-004; ng(n+1)=5.097629e+003;
n=2; farx(n+1)=1.409206e+004; foe(n+1)=1.430352e+004; krok(n+1)=1.915637e-003; ng(n+1)=2.960965e+002;
n=3; farx(n+1)=4.019429e+003; foe(n+1)=3.548089e+003; krok(n+1)=1.366331e-004; ng(n+1)=5.725778e+003;
n=4; farx(n+1)=4.429605e+003; foe(n+1)=3.339460e+003; krok(n+1)=2.442441e-007; ng(n+1)=5.817374e+004;
n=5; farx(n+1)=1.040391e+004; foe(n+1)=2.756573e+003; krok(n+1)=1.322977e-005; ng(n+1)=7.542743e+004;
n=6; farx(n+1)=1.370909e+004; foe(n+1)=2.547504e+003; krok(n+1)=4.780368e-005; ng(n+1)=1.923487e+004;
n=7; farx(n+1)=1.371760e+004; foe(n+1)=2.546831e+003; krok(n+1)=6.409618e-005; ng(n+1)=1.273044e+004;
n=8; farx(n+1)=4.794479e+003; foe(n+1)=2.298943e+003; krok(n+1)=2.125050e+000; ng(n+1)=1.270899e+004;
n=9; farx(n+1)=1.606469e+003; foe(n+1)=1.996468e+003; krok(n+1)=2.267028e+000; ng(n+1)=1.758811e+004;
n=10; farx(n+1)=1.395251e+003; foe(n+1)=1.984422e+003; krok(n+1)=1.032026e-001; ng(n+1)=2.126932e+004;
n=11; farx(n+1)=8.788720e+002; foe(n+1)=1.825532e+003; krok(n+1)=1.492172e+000; ng(n+1)=2.794095e+004;
n=12; farx(n+1)=2.611647e+002; foe(n+1)=1.398547e+003; krok(n+1)=1.514306e+000; ng(n+1)=2.303566e+004;
n=13; farx(n+1)=1.309476e+002; foe(n+1)=1.122590e+003; krok(n+1)=1.655202e-001; ng(n+1)=2.061610e+004;
n=14; farx(n+1)=3.229689e+001; foe(n+1)=5.150474e+002; krok(n+1)=2.223238e-001; ng(n+1)=6.548528e+004;
n=15; farx(n+1)=2.031522e+001; foe(n+1)=3.644895e+002; krok(n+1)=6.826594e-002; ng(n+1)=6.154412e+004;
n=16; farx(n+1)=2.251721e+001; foe(n+1)=2.752086e+002; krok(n+1)=3.644735e-001; ng(n+1)=2.377213e+004;
n=17; farx(n+1)=2.267179e+001; foe(n+1)=2.725357e+002; krok(n+1)=4.966524e-001; ng(n+1)=3.679920e+003;
n=18; farx(n+1)=2.206921e+001; foe(n+1)=2.690303e+002; krok(n+1)=6.197318e-001; ng(n+1)=4.846319e+003;
n=19; farx(n+1)=2.235133e+001; foe(n+1)=2.612172e+002; krok(n+1)=5.034415e+000; ng(n+1)=6.321433e+003;
n=20; farx(n+1)=2.266365e+001; foe(n+1)=2.587315e+002; krok(n+1)=1.549217e+000; ng(n+1)=7.279464e+003;
n=21; farx(n+1)=2.265324e+001; foe(n+1)=2.547059e+002; krok(n+1)=3.203543e+000; ng(n+1)=2.851079e+003;
n=22; farx(n+1)=2.048275e+001; foe(n+1)=2.484498e+002; krok(n+1)=2.794466e+000; ng(n+1)=2.555527e+003;
n=23; farx(n+1)=2.016023e+001; foe(n+1)=2.467636e+002; krok(n+1)=1.402391e+000; ng(n+1)=4.020325e+003;
n=24; farx(n+1)=1.997479e+001; foe(n+1)=2.463555e+002; krok(n+1)=6.674595e-001; ng(n+1)=2.682723e+003;
n=25; farx(n+1)=1.984948e+001; foe(n+1)=2.462839e+002; krok(n+1)=1.236406e+000; ng(n+1)=1.294364e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.985823e+001; foe(n+1)=2.462790e+002; krok(n+1)=9.632047e-008; ng(n+1)=4.223169e+002;
n=27; farx(n+1)=1.994863e+001; foe(n+1)=2.462678e+002; krok(n+1)=1.535151e-005; ng(n+1)=5.355039e+001;
n=28; farx(n+1)=1.999046e+001; foe(n+1)=2.462631e+002; krok(n+1)=5.834398e-006; ng(n+1)=6.228328e+001;
n=29; farx(n+1)=2.170626e+001; foe(n+1)=2.455539e+002; krok(n+1)=1.457389e-003; ng(n+1)=4.654034e+001;
n=30; farx(n+1)=2.178327e+001; foe(n+1)=2.453921e+002; krok(n+1)=1.320749e-003; ng(n+1)=4.490732e+001;
n=31; farx(n+1)=2.310660e+001; foe(n+1)=2.445528e+002; krok(n+1)=4.282689e-003; ng(n+1)=1.044416e+002;
n=32; farx(n+1)=2.323309e+001; foe(n+1)=2.445323e+002; krok(n+1)=1.226153e-002; ng(n+1)=8.436955e+002;
n=33; farx(n+1)=2.370385e+001; foe(n+1)=2.442206e+002; krok(n+1)=1.968605e+000; ng(n+1)=9.721190e+002;
n=34; farx(n+1)=2.370840e+001; foe(n+1)=2.441498e+002; krok(n+1)=1.174181e+000; ng(n+1)=6.278317e+002;
n=35; farx(n+1)=2.373678e+001; foe(n+1)=2.441459e+002; krok(n+1)=9.927086e-001; ng(n+1)=1.092320e+002;
n=36; farx(n+1)=2.378271e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.486426e-001; ng(n+1)=6.734533e+001;
n=37; farx(n+1)=2.377731e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.372047e-001; ng(n+1)=1.312102e+000;
n=38; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.854997e-001; ng(n+1)=1.392438e+000;
n=39; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.476581e+000; ng(n+1)=1.231979e+000;
n=40; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.125074e-006; ng(n+1)=2.085022e-002;
n=41; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.518345e-007; ng(n+1)=2.085019e-002;
n=42; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.071946e-010; ng(n+1)=2.085019e-002;
n=43; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.863099e-011; ng(n+1)=2.085019e-002;
 % z³y kierunek w metodzie zm - odnowa 
n=44; farx(n+1)=2.377775e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.475309e-007; ng(n+1)=2.085019e-002;
n=45; farx(n+1)=2.377774e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.840103e-006; ng(n+1)=1.956344e-002;
n=46; farx(n+1)=2.377772e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.288613e-006; ng(n+1)=1.116688e-002;
n=47; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.697036e-004; ng(n+1)=7.172080e-003;
n=48; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.612156e-009; ng(n+1)=5.093147e-003;
n=49; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.349696e-006; ng(n+1)=5.093147e-003;
n=50; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.430061e-005; ng(n+1)=5.090434e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.679253e-007; ng(n+1)=5.090315e-003;
n=52; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.032214e-006; ng(n+1)=4.881463e-003;
n=53; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.222290e-004; ng(n+1)=4.986220e-003;
n=54; farx(n+1)=2.377769e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.703468e-005; ng(n+1)=6.388158e-003;
n=55; farx(n+1)=2.377770e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.369522e-003; ng(n+1)=5.055555e-003;
n=56; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.096185e-003; ng(n+1)=4.731251e-003;
n=57; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.190752e-005; ng(n+1)=4.846923e-003;
n=58; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.801669e-005; ng(n+1)=4.846832e-003;
n=59; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.424403e-006; ng(n+1)=4.846695e-003;
n=60; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.833131e-008; ng(n+1)=4.846654e-003;
n=61; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.654423e-008; ng(n+1)=4.846653e-003;
n=62; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.656006e-009; ng(n+1)=4.846653e-003;
n=63; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.719210e-009; ng(n+1)=4.846653e-003;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
