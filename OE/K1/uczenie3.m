%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.873782e+004; foe(n+1)=1.846731e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.456507e+004; foe(n+1)=1.397287e+004; krok(n+1)=2.151482e-004; ng(n+1)=6.308963e+003;
n=2; farx(n+1)=3.238222e+003; foe(n+1)=2.079268e+003; krok(n+1)=1.525147e-003; ng(n+1)=3.660206e+003;
n=3; farx(n+1)=3.657840e+003; foe(n+1)=1.457716e+003; krok(n+1)=1.278270e-004; ng(n+1)=6.020664e+003;
n=4; farx(n+1)=2.642950e+003; foe(n+1)=1.381585e+003; krok(n+1)=8.336543e-004; ng(n+1)=1.073119e+003;
n=5; farx(n+1)=2.394527e+003; foe(n+1)=1.357390e+003; krok(n+1)=1.276921e-003; ng(n+1)=1.446856e+003;
n=6; farx(n+1)=2.476701e+003; foe(n+1)=1.348778e+003; krok(n+1)=5.200687e-003; ng(n+1)=1.213798e+003;
n=7; farx(n+1)=2.204357e+003; foe(n+1)=1.278757e+003; krok(n+1)=1.057221e-001; ng(n+1)=1.108790e+003;
n=8; farx(n+1)=1.171666e+003; foe(n+1)=1.054602e+003; krok(n+1)=1.625559e+000; ng(n+1)=1.287487e+003;
n=9; farx(n+1)=8.936402e+002; foe(n+1)=9.777680e+002; krok(n+1)=9.607629e-001; ng(n+1)=1.802712e+003;
n=10; farx(n+1)=8.700799e+002; foe(n+1)=9.563191e+002; krok(n+1)=2.889668e-001; ng(n+1)=1.645852e+003;
n=11; farx(n+1)=8.565249e+002; foe(n+1)=9.461119e+002; krok(n+1)=1.513224e-001; ng(n+1)=1.293349e+003;
n=12; farx(n+1)=8.725289e+002; foe(n+1)=9.386943e+002; krok(n+1)=9.769152e-001; ng(n+1)=3.721350e+002;
n=13; farx(n+1)=8.180533e+002; foe(n+1)=9.291277e+002; krok(n+1)=7.011953e-001; ng(n+1)=3.561108e+002;
n=14; farx(n+1)=5.006475e+002; foe(n+1)=8.818710e+002; krok(n+1)=1.754638e+000; ng(n+1)=5.301330e+002;
n=15; farx(n+1)=2.221682e+002; foe(n+1)=8.159043e+002; krok(n+1)=2.787051e-001; ng(n+1)=3.102378e+003;
n=16; farx(n+1)=2.162942e+002; foe(n+1)=8.136615e+002; krok(n+1)=2.855949e-003; ng(n+1)=4.683441e+003;
n=17; farx(n+1)=2.260693e+002; foe(n+1)=6.907881e+002; krok(n+1)=1.023163e+000; ng(n+1)=4.013418e+003;
n=18; farx(n+1)=1.658804e+002; foe(n+1)=5.841775e+002; krok(n+1)=4.635137e-001; ng(n+1)=1.874969e+003;
n=19; farx(n+1)=9.393746e+001; foe(n+1)=4.606240e+002; krok(n+1)=4.446475e-001; ng(n+1)=1.088582e+004;
n=20; farx(n+1)=8.610581e+001; foe(n+1)=4.409129e+002; krok(n+1)=5.019954e-002; ng(n+1)=2.849905e+003;
n=21; farx(n+1)=7.149320e+001; foe(n+1)=4.136087e+002; krok(n+1)=3.047347e-001; ng(n+1)=2.139554e+003;
n=22; farx(n+1)=7.202735e+001; foe(n+1)=3.921575e+002; krok(n+1)=2.286351e-001; ng(n+1)=3.346560e+003;
n=23; farx(n+1)=5.940602e+001; foe(n+1)=3.555928e+002; krok(n+1)=3.404866e-001; ng(n+1)=3.576975e+003;
n=24; farx(n+1)=5.627685e+001; foe(n+1)=3.397527e+002; krok(n+1)=4.324752e-001; ng(n+1)=1.222896e+004;
n=25; farx(n+1)=4.700535e+001; foe(n+1)=3.254020e+002; krok(n+1)=1.289896e+000; ng(n+1)=4.795195e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.762633e+001; foe(n+1)=3.247276e+002; krok(n+1)=5.676143e-007; ng(n+1)=1.887896e+003;
n=27; farx(n+1)=4.930428e+001; foe(n+1)=3.230793e+002; krok(n+1)=1.416371e-005; ng(n+1)=5.666158e+002;
n=28; farx(n+1)=4.758068e+001; foe(n+1)=3.072714e+002; krok(n+1)=1.282071e-003; ng(n+1)=1.725337e+002;
n=29; farx(n+1)=4.709265e+001; foe(n+1)=3.030073e+002; krok(n+1)=7.598256e-005; ng(n+1)=4.891062e+003;
n=30; farx(n+1)=4.962315e+001; foe(n+1)=3.000521e+002; krok(n+1)=3.569431e-004; ng(n+1)=8.229405e+003;
n=31; farx(n+1)=4.882951e+001; foe(n+1)=2.995602e+002; krok(n+1)=3.544455e-003; ng(n+1)=7.479278e+003;
n=32; farx(n+1)=3.663357e+001; foe(n+1)=2.865565e+002; krok(n+1)=1.779884e-002; ng(n+1)=7.646470e+003;
n=33; farx(n+1)=2.890219e+001; foe(n+1)=2.691461e+002; krok(n+1)=1.022846e+000; ng(n+1)=9.011524e+003;
n=34; farx(n+1)=2.828381e+001; foe(n+1)=2.585786e+002; krok(n+1)=1.098198e+000; ng(n+1)=1.568256e+003;
n=35; farx(n+1)=2.839066e+001; foe(n+1)=2.538163e+002; krok(n+1)=2.193298e-001; ng(n+1)=1.007587e+003;
n=36; farx(n+1)=2.688021e+001; foe(n+1)=2.501933e+002; krok(n+1)=4.126070e-001; ng(n+1)=5.317468e+003;
n=37; farx(n+1)=2.505300e+001; foe(n+1)=2.472625e+002; krok(n+1)=6.954939e-001; ng(n+1)=3.630659e+003;
n=38; farx(n+1)=2.485375e+001; foe(n+1)=2.463474e+002; krok(n+1)=2.640676e-001; ng(n+1)=3.962811e+002;
n=39; farx(n+1)=2.424034e+001; foe(n+1)=2.452209e+002; krok(n+1)=5.155493e-001; ng(n+1)=1.937564e+003;
n=40; farx(n+1)=2.476088e+001; foe(n+1)=2.445345e+002; krok(n+1)=1.024631e+000; ng(n+1)=1.473120e+003;
n=41; farx(n+1)=2.419926e+001; foe(n+1)=2.443334e+002; krok(n+1)=8.295027e-001; ng(n+1)=1.132924e+003;
n=42; farx(n+1)=2.396795e+001; foe(n+1)=2.442358e+002; krok(n+1)=5.982775e-001; ng(n+1)=5.635212e+002;
n=43; farx(n+1)=2.403150e+001; foe(n+1)=2.442104e+002; krok(n+1)=1.458994e+000; ng(n+1)=1.343814e+002;
n=44; farx(n+1)=2.397106e+001; foe(n+1)=2.441926e+002; krok(n+1)=3.300856e+000; ng(n+1)=1.969190e+001;
n=45; farx(n+1)=2.376436e+001; foe(n+1)=2.441710e+002; krok(n+1)=1.605990e+000; ng(n+1)=3.723660e+002;
n=46; farx(n+1)=2.379086e+001; foe(n+1)=2.441476e+002; krok(n+1)=1.613595e+000; ng(n+1)=1.550574e+002;
n=47; farx(n+1)=2.380514e+001; foe(n+1)=2.441455e+002; krok(n+1)=1.371445e+000; ng(n+1)=2.720160e+001;
n=48; farx(n+1)=2.377703e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.817806e+000; ng(n+1)=4.259890e+001;
n=49; farx(n+1)=2.377818e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.077223e+000; ng(n+1)=7.088772e+000;
n=50; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.094828e+000; ng(n+1)=4.163119e-001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.828915e-007; ng(n+1)=3.651428e-002;
n=52; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.625333e-006; ng(n+1)=1.948896e-002;
n=53; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.108077e-005; ng(n+1)=9.105675e-003;
n=54; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.827214e-004; ng(n+1)=7.790133e-003;
n=55; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.651148e-005; ng(n+1)=7.650472e-003;
n=56; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.860122e-005; ng(n+1)=7.651030e-003;
n=57; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.926265e-006; ng(n+1)=7.649412e-003;
n=58; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.908880e-008; ng(n+1)=7.649390e-003;
n=59; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.568750e-008; ng(n+1)=7.649383e-003;
n=60; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.566881e-009; ng(n+1)=7.649383e-003;
n=61; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=8.290920e-011; ng(n+1)=7.649383e-003;
n=62; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.103626e-010; ng(n+1)=7.649382e-003;
n=63; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.136803e-011; ng(n+1)=7.649382e-003;
n=64; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.163364e-007; ng(n+1)=7.649382e-003;
n=65; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.803830e-007; ng(n+1)=7.648606e-003;
n=66; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.550946e-009; ng(n+1)=7.648598e-003;
n=67; farx(n+1)=2.377777e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.115396e-010; ng(n+1)=7.648598e-003;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
