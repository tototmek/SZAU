%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.837733e+004; foe(n+1)=1.851111e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.378477e+004; foe(n+1)=1.417689e+004; krok(n+1)=1.999716e-004; ng(n+1)=5.947312e+003;
n=2; farx(n+1)=2.453117e+003; foe(n+1)=1.857833e+003; krok(n+1)=2.204222e-003; ng(n+1)=2.824388e+003;
n=3; farx(n+1)=2.278810e+003; foe(n+1)=1.310364e+003; krok(n+1)=1.280208e-004; ng(n+1)=5.376696e+003;
n=4; farx(n+1)=2.076981e+003; foe(n+1)=1.263667e+003; krok(n+1)=9.409085e-004; ng(n+1)=1.189238e+003;
n=5; farx(n+1)=1.518562e+003; foe(n+1)=1.201151e+003; krok(n+1)=1.861026e-003; ng(n+1)=8.667791e+002;
n=6; farx(n+1)=1.512064e+003; foe(n+1)=1.192068e+003; krok(n+1)=7.585473e-003; ng(n+1)=1.370017e+003;
n=7; farx(n+1)=1.370324e+003; foe(n+1)=1.103443e+003; krok(n+1)=1.919924e-001; ng(n+1)=1.330874e+003;
n=8; farx(n+1)=1.042587e+003; foe(n+1)=9.890882e+002; krok(n+1)=8.536620e-001; ng(n+1)=1.427586e+003;
n=9; farx(n+1)=1.065098e+003; foe(n+1)=9.846697e+002; krok(n+1)=7.927530e-001; ng(n+1)=1.802071e+002;
n=10; farx(n+1)=1.072334e+003; foe(n+1)=9.818208e+002; krok(n+1)=5.365271e-001; ng(n+1)=1.306115e+002;
n=11; farx(n+1)=1.042329e+003; foe(n+1)=9.768617e+002; krok(n+1)=1.454334e+000; ng(n+1)=2.751561e+002;
n=12; farx(n+1)=9.673577e+002; foe(n+1)=9.707071e+002; krok(n+1)=2.278251e+000; ng(n+1)=1.551964e+002;
n=13; farx(n+1)=8.130380e+002; foe(n+1)=9.592244e+002; krok(n+1)=6.426558e-001; ng(n+1)=3.300990e+002;
n=14; farx(n+1)=3.076205e+002; foe(n+1)=8.178270e+002; krok(n+1)=4.714530e-001; ng(n+1)=6.675435e+002;
n=15; farx(n+1)=3.038794e+002; foe(n+1)=8.175977e+002; krok(n+1)=2.084136e-004; ng(n+1)=2.738402e+003;
n=16; farx(n+1)=2.475976e+002; foe(n+1)=7.934268e+002; krok(n+1)=7.679697e-001; ng(n+1)=2.432304e+003;
n=17; farx(n+1)=1.652393e+002; foe(n+1)=7.208931e+002; krok(n+1)=3.691454e-001; ng(n+1)=4.399332e+003;
n=18; farx(n+1)=1.628683e+002; foe(n+1)=6.508059e+002; krok(n+1)=4.177026e-001; ng(n+1)=5.250344e+003;
n=19; farx(n+1)=1.766575e+002; foe(n+1)=5.866451e+002; krok(n+1)=1.005024e-001; ng(n+1)=6.515495e+003;
n=20; farx(n+1)=1.030305e+002; foe(n+1)=4.717997e+002; krok(n+1)=1.189063e+000; ng(n+1)=2.326939e+003;
n=21; farx(n+1)=9.083836e+001; foe(n+1)=4.280092e+002; krok(n+1)=4.686024e-001; ng(n+1)=1.939299e+003;
n=22; farx(n+1)=8.434323e+001; foe(n+1)=4.027971e+002; krok(n+1)=2.442288e-001; ng(n+1)=8.202505e+003;
n=23; farx(n+1)=4.865305e+001; foe(n+1)=3.528275e+002; krok(n+1)=9.089030e-001; ng(n+1)=3.683542e+003;
n=24; farx(n+1)=3.867007e+001; foe(n+1)=3.041098e+002; krok(n+1)=7.413928e-001; ng(n+1)=3.407008e+003;
n=25; farx(n+1)=3.637461e+001; foe(n+1)=2.940640e+002; krok(n+1)=5.481842e-001; ng(n+1)=6.349088e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.504458e+001; foe(n+1)=2.928050e+002; krok(n+1)=2.308996e-006; ng(n+1)=1.765355e+003;
n=27; farx(n+1)=3.268750e+001; foe(n+1)=2.872992e+002; krok(n+1)=2.559396e-006; ng(n+1)=3.398718e+003;
n=28; farx(n+1)=3.139991e+001; foe(n+1)=2.843833e+002; krok(n+1)=7.472543e-005; ng(n+1)=4.626915e+002;
n=29; farx(n+1)=3.080897e+001; foe(n+1)=2.775824e+002; krok(n+1)=3.927263e-004; ng(n+1)=4.370452e+002;
n=30; farx(n+1)=3.004959e+001; foe(n+1)=2.649116e+002; krok(n+1)=5.469456e-004; ng(n+1)=7.382592e+002;
n=31; farx(n+1)=2.968068e+001; foe(n+1)=2.647286e+002; krok(n+1)=3.254643e-004; ng(n+1)=3.688403e+003;
n=32; farx(n+1)=2.825081e+001; foe(n+1)=2.637298e+002; krok(n+1)=4.545636e-002; ng(n+1)=4.665528e+003;
n=33; farx(n+1)=2.688877e+001; foe(n+1)=2.515063e+002; krok(n+1)=1.091740e+000; ng(n+1)=5.054056e+003;
n=34; farx(n+1)=2.630381e+001; foe(n+1)=2.478573e+002; krok(n+1)=5.168655e-001; ng(n+1)=5.508298e+002;
n=35; farx(n+1)=2.485115e+001; foe(n+1)=2.461935e+002; krok(n+1)=4.686024e-001; ng(n+1)=2.098581e+003;
n=36; farx(n+1)=2.391100e+001; foe(n+1)=2.450675e+002; krok(n+1)=1.462039e+000; ng(n+1)=6.360770e+002;
n=37; farx(n+1)=2.452566e+001; foe(n+1)=2.443889e+002; krok(n+1)=7.741360e-001; ng(n+1)=2.079807e+003;
n=38; farx(n+1)=2.428694e+001; foe(n+1)=2.442477e+002; krok(n+1)=9.112329e-001; ng(n+1)=1.625542e+002;
n=39; farx(n+1)=2.397240e+001; foe(n+1)=2.442016e+002; krok(n+1)=7.583720e-001; ng(n+1)=2.921665e+002;
n=40; farx(n+1)=2.393683e+001; foe(n+1)=2.441938e+002; krok(n+1)=7.807902e-001; ng(n+1)=1.641730e+002;
n=41; farx(n+1)=2.398267e+001; foe(n+1)=2.441852e+002; krok(n+1)=9.942122e-001; ng(n+1)=1.440624e+002;
n=42; farx(n+1)=2.393657e+001; foe(n+1)=2.441662e+002; krok(n+1)=3.907661e+000; ng(n+1)=2.723600e+001;
n=43; farx(n+1)=2.374681e+001; foe(n+1)=2.441457e+002; krok(n+1)=1.827122e+000; ng(n+1)=3.049538e+002;
n=44; farx(n+1)=2.377346e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.073805e-001; ng(n+1)=4.063693e+001;
n=45; farx(n+1)=2.377728e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.017241e+000; ng(n+1)=4.680767e+000;
n=46; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.120145e+000; ng(n+1)=1.709017e+000;
n=47; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.676357e-007; ng(n+1)=3.899599e-002;
n=48; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=7.360305e-011; ng(n+1)=3.899599e-002;
n=49; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.165456e-006; ng(n+1)=3.899599e-002;
n=50; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.628105e-005; ng(n+1)=3.895134e-002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.377768e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.051186e-007; ng(n+1)=3.895065e-002;
n=52; farx(n+1)=2.377769e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.827915e-006; ng(n+1)=3.401749e-002;
n=53; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.108665e-005; ng(n+1)=1.239513e-002;
n=54; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.999795e-004; ng(n+1)=1.174920e-002;
n=55; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.649970e-005; ng(n+1)=5.362102e-003;
n=56; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.976235e-006; ng(n+1)=5.361788e-003;
n=57; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.718383e-006; ng(n+1)=5.361778e-003;
n=58; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.166263e-009; ng(n+1)=5.361764e-003;
n=59; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.986655e-008; ng(n+1)=5.361763e-003;
n=60; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.368272e-010; ng(n+1)=5.361763e-003;
n=61; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.693188e-011; ng(n+1)=5.361763e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=62; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.404220e-008; ng(n+1)=5.361763e-003;
n=63; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.657027e-006; ng(n+1)=3.550010e-003;
n=64; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.743488e-007; ng(n+1)=3.108739e-003;
n=65; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.024546e-007; ng(n+1)=3.058650e-003;
n=66; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.457687e-005; ng(n+1)=3.058646e-003;
n=67; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=5.632711e-006; ng(n+1)=3.059115e-003;
n=68; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.146870e-006; ng(n+1)=3.059035e-003;
n=69; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.491360e-009; ng(n+1)=3.058881e-003;
n=70; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.936325e-009; ng(n+1)=3.058881e-003;
n=71; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.898578e-007; ng(n+1)=3.058881e-003;
n=72; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.426604e-011; ng(n+1)=3.058869e-003;
n=73; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.982719e-009; ng(n+1)=3.058869e-003;
n=74; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.811007e-006; ng(n+1)=3.058868e-003;
n=75; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.540928e-006; ng(n+1)=3.058919e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.614126e-007; ng(n+1)=3.058921e-003;
n=77; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.602457e-006; ng(n+1)=3.278547e-003;
n=78; farx(n+1)=2.377776e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.569632e-005; ng(n+1)=2.621903e-003;
n=79; farx(n+1)=2.377774e+001; foe(n+1)=2.441451e+002; krok(n+1)=3.549232e-003; ng(n+1)=3.189006e-003;
n=80; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.844458e-003; ng(n+1)=2.598087e-003;
n=81; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.548640e-010; ng(n+1)=2.595083e-003;
n=82; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=2.148709e-011; ng(n+1)=2.595083e-003;
n=83; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=6.687119e-007; ng(n+1)=2.595083e-003;
n=84; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.298185e-005; ng(n+1)=2.593616e-003;
n=85; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.069939e-005; ng(n+1)=2.593446e-003;
n=86; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.029352e-006; ng(n+1)=2.593362e-003;
n=87; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.152530e-008; ng(n+1)=2.593360e-003;
n=88; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.586728e-009; ng(n+1)=2.593360e-003;
n=89; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=9.329058e-007; ng(n+1)=2.593360e-003;
n=90; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.936574e-006; ng(n+1)=2.593347e-003;
n=91; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.390241e-007; ng(n+1)=2.593343e-003;
n=92; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=4.816698e-008; ng(n+1)=2.593343e-003;
n=93; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.566626e-007; ng(n+1)=2.593344e-003;
n=94; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.339987e-007; ng(n+1)=2.593344e-003;
n=95; farx(n+1)=2.377773e+001; foe(n+1)=2.441451e+002; krok(n+1)=1.843811e-008; ng(n+1)=2.593343e-003;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
